description: Check if a Docker image exists
parameters:
  image_repo:
    description: The container image repository
    type: string
  request_remote_docker:
    description: Add the option to request a new remote docker, set to false when you concat docker jobs
    type: boolean
    default: true
steps:
  - when:
      condition: << parameters.request_remote_docker >>
      steps:
        - setup_remote_docker:  # Need this to run DinD
            version: 20.10.11
  - docker_login
  - run:
      name: If container with this git SHA already exists, don't build
      environment:
        IMAGE_REPO: << parameters.image_repo >>
      command: <<include(scripts/utils/check-image-exists.sh)>>
