description: Uses vfcli to suspend an existing environment with a set of tracks (vfcli must already be installed)

parameters:
  env-name:
    type: string
    description: Name of the environment to prepare
  track-file:
    type: string
    description: Path to the track-mapping file to use
  working_directory:
    description: Directory of git repo
    type: string
    default: "."
steps:
  - attach_workspace:
      at: workspace
  - run:
      name: Suspend Environment
      command: |
        env_name=$(cat workspace/env_name)
        if [[ "$env_name" == "null" ]] || [[ -z "$env_name" ]]; then
          # If env_name from file is "null" or empty, use the default parameter
          env_name="<< parameters.env-name >>"        
        fi
        
        vfcli env suspend "$env_name" --interactive false --track-file "<< parameters.track-file >>"
