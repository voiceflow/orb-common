description: Uses vfcli to suspend an existing environment with a set of tracks (vfcli must already be installed)

parameters:
  env-name:
    type: string
    description: Name of the environment to prepare
  track-file:
    type: string
    description: Path to the track-mapping file to use
steps:
  - attach_workspace:
      at: workspace
  - run:
      name: Suspend Environment
      command: |
        if [[ -f "workspace/env_name" ]]; then
          env_name=$(cat workspace/env_name)
        else
          env_name="<< parameters.env-name >>"
        fi

        vfcli env suspend "$env_name" --interactive false --track-file "<< parameters.track-file >>"
        