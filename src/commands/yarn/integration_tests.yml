parameters:
  working_directory:
    description: Directory containing package.json
    type: string
    default: "./"
  run_in_background:
    description: run the command in background
    type: boolean
    default: false
  step_name:
    description: Name of the step
    type: string
    default: Integration Tests
  extra_args:
    description: Additional yarn command options
    type: string
    default: ""
  wait:
    description: wait until all the commands are finished
    type: boolean
    default: false
  run_in_container:
    description: Run build in a container
    type: boolean
    default: false
  request_remote_docker:
    description: Request remote Docker
    type: boolean
    default: false
  container_image:
    description: Container image to run the yarn command
    type: string
    default: "168387678261.dkr.ecr.us-east-1.amazonaws.com/ci-node-build-image:v1"
  container_folder_to_copy:
    description: Container folder to copy after the execution
    type: string
    default: ""
steps:
  - set_etc_hosts_e2e
  - yarn_command:
      working_directory: << parameters.working_directory >>
      run_in_background: << parameters.run_in_background >>
      request_remote_docker: << parameters.request_remote_docker >>
      container_folder_to_copy: << parameters.container_folder_to_copy >>
      run_in_container: << parameters.run_in_container >>
      container_image: << parameters.container_image >>
      step_name: << parameters.step_name >>
      wait: << parameters.wait >>
      yarn_command: yarn test:integration << parameters.extra_args >>
