description: Uses vfcli fetch the logs for all comopnents and store them in artifacts

parameters:
  env-name:
    type: string
    description: Name of the environment to create
  destination:
    type: string
    description: Destination directory for the logs
    default: logs
steps:
  - run:
      name: Gather Logs
      environment:
        ENV_NAME: << parameters.env-name >>
        LOG_DIR: &log_dir /tmp/e2e-logs-<< parameters.env-name >>
      command: |
        vfcli logs gather-all "${LOG_DIR:?}" --name "${ENV_NAME:?}"
  - store_artifacts:
      path: *log_dir
      destination: << parameters.destination >>
