parameters:
  executor:
    description: Executor to run the command on
    type: executor
    default: node-executor-node-20
  command:
    description: Script to check types
    type: string
    default: yarn test:types --summarize true
executor: << parameters.executor >>
steps:
  - checkout_clone
  - attach_workspace:
      at: ~/voiceflow
  - turborepo_install
  - turborepo_generate_hashfile:
      prefix: build-cache
      command: yarn build
  - turborepo_generate_hashfile:
      prefix: types-test-cache
      command: << parameters.command >>
  - turborepo_restore_cache:
      fallback_prefix: build-cache
      prefix: types-test-cache
  - run:
      command: << parameters.command >>
  - turborepo_store_summaries
  - turborepo_save_cache:
      prefix: types-test-cache
