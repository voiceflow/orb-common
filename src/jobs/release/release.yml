executor: node-executor
parameters:
  install_args:
    description: Additional yarn install command options
    type: string
    default: ""
  sentry_project:
    description: Sentry project to associate the release with
    type: string
    default: ""
  avoid_post_install_scripts:
    description: Skip running post install scripts
    type: boolean
    default: true
  working_directory:
    description: Directory containing package.json
    type: string
    default: ~/voiceflow
steps:
  - checkout
  - install_node_modules:
      install_args: "<< parameters.install_args >>"
      avoid_post_install_scripts: "<< parameters.avoid_post_install_scripts >>"
      working_directory: << parameters.working_directory >>
  - attach_workspace:
      at: << parameters.working_directory >>
  - run:
      name: Release Package
      working_directory: << parameters.working_directory >>
      command: "SENTRY_PROJECT=<< parameters.sentry_project >> npx semantic-release@17\n"
